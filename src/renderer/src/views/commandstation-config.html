<template>
    <import from="../components/app-layout"></import>
    <import from="../components/nav-bar"></import>

    <app-layout title="EX-CommandStation Configuration">
        <div class="max-w-3xl mx-auto space-y-6">
            <!-- Motor Driver -->
            <div class="border rounded-lg p-4 space-y-3">
                <h3 class="font-semibold text-gray-800">Motor Driver</h3>
                <select value.bind="motorDriver" class="w-full border rounded-lg px-3 py-2">
                    <option value="">-- Select Motor Driver --</option>
                    <option repeat.for="driver of motorDrivers" value.bind="driver">${driver}</option>
                </select>
            </div>

            <!-- Display -->
            <div class="border rounded-lg p-4 space-y-3">
                <h3 class="font-semibold text-gray-800">Display</h3>
                <div class="grid grid-cols-2 gap-2">
                    <label repeat.for="d of displayOptions" class="flex items-center gap-2 cursor-pointer">
                        <input type="radio" name="display" value.bind="d.value" checked.bind="display"
                            class="w-4 h-4 text-blue-600" />
                        <span>${d.label}</span>
                    </label>
                </div>
            </div>

            <!-- WiFi Configuration -->
            <div class="border rounded-lg p-4 space-y-3">
                <div class="flex items-center justify-between">
                    <h3 class="font-semibold text-gray-800">WiFi</h3>
                    <label class="flex items-center gap-2 cursor-pointer">
                        <input type="checkbox" checked.bind="enableWifi" class="w-4 h-4 text-blue-600 rounded" />
                        <span class="text-sm">Enable</span>
                    </label>
                </div>

                <div if.bind="enableWifi" class="space-y-3 pl-2">
                    <div class="space-y-1">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="wifiMode" value="ap" checked.bind="wifiMode"
                                class="w-4 h-4 text-blue-600" />
                            <span>Access Point (AP mode)</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="radio" name="wifiMode" value="sta" checked.bind="wifiMode"
                                class="w-4 h-4 text-blue-600" />
                            <span>Connect to existing network (Station mode)</span>
                        </label>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">SSID</label>
                            <input type="text" value.bind="wifiSsid" class="w-full px-3 py-2 border rounded" />
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Password</label>
                            <input type="password" value.bind="wifiPassword" class="w-full px-3 py-2 border rounded" />
                        </div>
                    </div>

                    <div if.bind="wifiMode === 'ap'">
                        <label class="block text-sm font-medium text-gray-700 mb-1">WiFi Channel (1-11)</label>
                        <input type="number" value.bind="wifiChannel" min="1" max="11"
                            class="w-24 px-3 py-2 border rounded" />
                    </div>
                </div>
            </div>

            <!-- Track Manager (v4.2+) -->
            <div class="border rounded-lg p-4 space-y-3">
                <h3 class="font-semibold text-gray-800">Track Manager</h3>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Track A Mode</label>
                        <select value.bind="trackAMode" class="w-full border rounded-lg px-3 py-2">
                            <option repeat.for="mode of trackModes" value.bind="mode.value">${mode.label}</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Track B Mode</label>
                        <select value.bind="trackBMode" class="w-full border rounded-lg px-3 py-2">
                            <option repeat.for="mode of trackModes" value.bind="mode.value">${mode.label}</option>
                        </select>
                    </div>
                </div>
                <div if.bind="trackAMode === 'DC' || trackAMode === 'DCX'" class="mt-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Track A DC Loco Address</label>
                    <input type="number" value.bind="trackALocoId" min="1" class="w-24 px-3 py-2 border rounded" />
                </div>
                <div if.bind="trackBMode === 'DC' || trackBMode === 'DCX'" class="mt-2">
                    <label class="block text-sm font-medium text-gray-700 mb-1">Track B DC Loco Address</label>
                    <input type="number" value.bind="trackBLocoId" min="1" class="w-24 px-3 py-2 border rounded" />
                </div>
            </div>

            <!-- Options -->
            <div class="border rounded-lg p-4 space-y-3">
                <h3 class="font-semibold text-gray-800">Options</h3>
                <label class="flex items-center gap-3 cursor-pointer">
                    <input type="checkbox" checked.bind="enablePowerOnStart" class="w-4 h-4 text-blue-600 rounded" />
                    <span>Power on at startup</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                    <input type="checkbox" checked.bind="disableEeprom" class="w-4 h-4 text-blue-600 rounded" />
                    <span>Disable EEPROM</span>
                </label>
                <label class="flex items-center gap-3 cursor-pointer">
                    <input type="checkbox" checked.bind="enableAdvancedConfig" class="w-4 h-4 text-blue-600 rounded" />
                    <span>Review/edit config files before compiling</span>
                </label>
            </div>

            <!-- Error -->
            <div if.bind="error" class="bg-red-50 border border-red-200 rounded-lg p-4">
                <p class="text-red-700">${error}</p>
            </div>
        </div>

        <nav-bar au-slot="footer" back-action.bind="() => goBack()" next-action.bind="() => goNext()"
            next-disabled.bind="!motorDriver">
        </nav-bar>
    </app-layout>
</template>